function CONSORT_EXP() {
    return [129, 336, 694, 1300, 2276, 3768, 5946, 9004, 13161, 18661, 25771, 34782, 46011, 59798, 76507, 96528, 120273, 148181,
        180713, 218355, 261617, 311034, 367166, 430595, 501930, 581802, 670867, 769806, 879324, 1000149, 1133036, 1278762,
        1438129, 1611963, 1801115, 2006460, 2228897, 2469349, 2728765, 3008116, 3308399, 3630635, 3975868, 4345168, 4739629,
        5160369, 5608529, 6085277, 6591803, 7129322, 7699074, 8302322, 8940354, 9614483, 10326045, 11076402, 11866938, 12699063,
        13574211, 14493840, 15459432, 16472494, 17534557, 18647177, 19811933, 21030429, 22304293, 23635177, 25024759, 26474740,
        27986845, 29562823, 31204449, 32913521, 34691862, 36541319, 38463762, 40461088, 42535216, 44688090, 46921679,
        49237976, 51638997, 54126784, 56703402, 59370942, 62131517, 64987266, 67940352, 70992962, 74147308, 77405625, 80770173,
        84243236, 87827124, 91524169, 95336728, 99267183, 103317939, 107491427, 111790101, 116216440, 120772947, 125462149,
        130286598, 135248870, 140351565, 145597307, 150988745, 156528553, 162219428, 168064091, 174065289, 180225792, 186548394,
        193035915, 199691197, 206517108, 213516540, 220692410, 228047657, 235585246, 243308167, 251219432, 259322079, 267619171,
        276113793, 284809056, 293708095, 302814068, 312130160, 321659578, 331405554, 341371344, 351560229, 361975514, 372620528,
        383498624, 394613181, 405967600, 417565308, 429409756, 441504418, 453852794, 466458408, 479324808, 492455565, 505854277,
        519524564, 533470071, 547694468, 562201448, 576994729, 592078054, 607455189, 623129926, 639106079, 655387488, 671978017,
        688881554, 706102011, 723643325, 741509457, 759704393, 778232142, 797096738, 816302239, 835852727, 855752310, 876005118,
        896615308, 917587058, 938924573, 960632081, 982713835, 1005174112, 1028017212, 1051247462, 1074869211, 1098886833,
        1123304727, 1148127315, 1173359045, 1199004388, 1225067839, 1251553918, 1278467170, 1305812163, 1333593490, 1361815768,
        1390483638, 1419601767, 1449174844, 1479207583, 1509704723, 1540671027, 1572111283, 1604030301, 1636432918, 1669323994,
        1702708413, 1736591084, 1770976940, 1805870938, 1841278060, 1877203311, 1913651722, 1950628348, 1988138267, 2026186583,
        2064778422, 2103918937, 2143613304, 2183866722, 2224684417, 2266071637, 2308033656, 2350575771, 2393703304, 2437421601,
        2481736033, 2526651994, 2572174903, 2618310204, 2665063364, 2712439875, 2760445254, 2809085041, 2858364800, 2908290121,
        2958866617, 3010099926, 3061995710, 3114559655, 3167797472, 3221714896, 3276317686, 3331611626, 3387602523, 3444296210,
        3501698543, 3559815402, 3618652693, 3678216345, 3738512312, 3799546571, 3861325125, 3923854000, 3987139247, 4051186941,
        4116003182, 4181594093, 4247965823, 4315124543, 4383076451, 4451827767, 4521384736, 4591753628, 4662940737, 4734952381,
        4807794902, 4881474668, 4955998069, 5031371520, 5107601461, 5184694356, 5262656693, 5341494985, 5421215768, 5501825604,
        5583331078, 5665738800, 5749055403, 5833287546, 5918441912, 6004525208, 6091544165, 6179505538, 6268416107, 6358282676,
        6449112074, 6540911154, 6633686792, 6727445890, 6822195373, 6917942192, 7014693320, 7112455756, 7211236523, 7311042668,
        7411881263, 7513759403, 7616684208, 7720662822, 7825702414, 7931810177, 8038993329, 8147259110, 8256614787, 8367067650,
        8478625013, 8591294215, 8705082619, 8819997612, 8936046606, 9053237036, 9171576363, 9291072072, 9411731671, 9533562693,
        9656572696, 9780769262, 9906159996, 10032752529, 10160554516, 10289573635, 10419817590, 10551294108, 10684010941, 10817975865,
        10953196681, 11089681213, 11227437310, 11366472846, 11506795718, 11648413848, 11791335182, 11935567691, 12081119370, 12227998238,
        12376212338, 12525769738, 12676678530, 12828946830, 12982582779, 13137594542, 13293990308, 13451778290, 13610966727, 13771563880,
        13933578036, 14097017506, 14261890624, 14428205750, 14595971268, 14765195585, 14935887134, 15108054371, 15281705777, 15456849858,
        15633495142, 15811650184, 15991323561, 16172523876, 16355259755, 16539539849, 16725372834, 16912767409, 17101732297, 17292276247,
        17484408032, 17678136448, 17873470316, 18070418481, 18268989813, 18469193206, 18671037578, 18874531872, 19079685054, 19286506116,
        19495004073, 19705187964, 19917066854, 20130649831, 20345946008, 20562964522, 20781714533, 21002205228, 21224445816, 21448445531,
        21674213632, 21901759401, 22131092146, 22362221198, 22595155912, 22829905668, 23066479871, 23304887949, 23545139355, 23787243566,
        24031210083, 24277048432, 24524768163, 24774378851, 25025890094, 25279311515, 25534652761, 25791923504, 26051133439, 26312292287,
        26575409792, 26840495723, 27107559873, 27376612059, 27647662123, 27920719930, 28195795371, 28472898361, 28752038838, 29033226765,
        29316472130, 29601784945, 29889175245, 30178653091, 30470228568, 30763911784, 31059712873, 31357641992, 31657709323, 31959925072,
        32264299469, 32570842770, 32879565253, 33190477221, 33503589002, 33818910949, 34136453437, 34456226867, 34778241663, 35102508275,
        35429037176, 35757838864, 36088923861, 36422302713, 36757985991, 37095984290, 37436308229, 37778968452, 38123975626, 38471340443,
        38821073620, 39173185898, 39527688042, 39884590841, 40243905108, 40605641682, 40969811424, 41336425222, 41705493986, 42077028651,
        42451040176, 42827539546, 43206537768, 43588045875, 43972074923, 44358635993, 44747740190, 45139398644, 45533622509, 45930422963,
        46329811208, 46731798471, 47136396003, 47543615080, 47953467001, 48365963090, 48781114695, 49198933188, 49619429967, 50042616452,
        50468504089, 50897104348, 51328428723, 51762488732, 52199295917, 52638861846, 53081198110, 53526316324, 53974228128, 54424945186,
        54878479187, 55334841843, 55794044892, 56256100095, 56721019237, 57188814128, 57659496603, 58133078520, 58609571762, 59088988236,
        59571339873, 60056638629, 60544896484, 61036125443, 61530337534, 62027544810, 62527759348, 63030993250, 63537258641, 64046567672];
}

/**
 * Returns the experience spended to up consort to current level.
 *
 * @param {number} level The cell with number of current level.
 * @return The spended experience amount.
 * @customfunction
 */
function get_exp(level) {
    return CONSORT_EXP()[level - 1];
}

/**
 * Returns the experience spended to up consort to current level.
 *
 * @param {number} current_level The cell with number of current level.
 * @param {number} exp_to_spend The cell with number of current level.
 * @return The spended experience amount.
 * @customfunction
 */
function consort_up_array(current_level) {
    const current_exp = get_exp(current_level);
    return CONSORT_EXP().map(function (v, i) {
        return v - current_exp;
    }).slice(current_level);
}


/**
 * Returns the experience spended to up consort to current level.
 *
 * @param {number} current_level The cell with number of current level.
 * @param {number} exp_to_spend The cell with number of current level.
 * @return The spended experience amount.
 * @customfunction
 */
function consort_level(current_level, exp_to_spend) {
    current_level = Number(current_level);
    exp_to_spend = Number(exp_to_spend);
    let next_exp_array = consort_up_array(current_level);
    let res = -1;

    for (var i = 0; i < next_exp_array.length; i++) {

        if (next_exp_array[i] - exp_to_spend >= 0) {
            res = current_level + i;
            document.getElementById("result").value = res;
            return res;
        }
    }
    return res;
}
